@page
@model RegisterModel

@{
    ViewData["Title"] = "Register";
}

<div class="w-full max-w-[400px] mx-auto mt-16 p-6 bg-[var(--sl-color-neutral-0)]
            rounded-xl shadow-lg font-base">

    <h1 class="font-title text-3xl mb-6 text-center">@ViewData["Title"]</h1>

    <form id="registerForm"
          asp-route-returnUrl="@Model.ReturnUrl"
          method="post"
          class="space-y-4">

        <!-- Validation Summary -->
        <div asp-validation-summary="ModelOnly"
             class="text-red-500 text-sm"
             role="alert">
        </div>

        <!-- Email -->
        <div>
            <label asp-for="Input.Email"
                   class="block text-sm mb-1 font-medium">
                Email
            </label>

            <sl-input
                asp-for="Input.Email"
                type="email"
                autocomplete="username"
                required
                placeholder="name@example.com"
                class="w-full">
            </sl-input>

            <span asp-validation-for="Input.Email"
                  class="text-red-500 text-sm"></span>
        </div>

        <!-- Password -->
        <div>
            <label asp-for="Input.Password"
                   class="block text-sm mb-1 font-medium">
                Password
            </label>

            <sl-input
                asp-for="Input.Password"
                type="password"
                autocomplete="new-password"
                required
                placeholder="••••••••"
                password-toggle
                class="w-full">
            </sl-input>

            <span asp-validation-for="Input.Password"
                  class="text-red-500 text-sm"></span>
        </div>

        <!-- Confirm Password -->
        <div>
            <label asp-for="Input.ConfirmPassword"
                   class="block text-sm mb-1 font-medium">
                Confirm Password
            </label>

            <sl-input
                asp-for="Input.ConfirmPassword"
                type="password"
                autocomplete="new-password"
                required
                placeholder="••••••••"
                password-toggle
                class="w-full">
            </sl-input>

            <span asp-validation-for="Input.ConfirmPassword"
                  class="text-red-500 text-sm"></span>
        </div>

        <!-- Submit button -->
        <sl-button id="registerSubmit"
                   type="submit"
                   variant="primary"
                   class="w-full">
            Register
        </sl-button>
    </form>

    <!-- External Providers -->
    @if ((Model.ExternalLogins?.Count ?? 0) > 0)
    {
        <div class="mt-8 pt-6 border-t border-[var(--sl-color-neutral-300)]">

            <h3 class="font-title text-xl mb-4 text-center">
                Use another service to register
            </h3>

            <form id="external-account"
                  asp-page="./ExternalLogin"
                  asp-route-returnUrl="@Model.ReturnUrl"
                  method="post"
                  class="flex flex-col gap-2">

                @foreach (var provider in Model.ExternalLogins!)
                {
                    <sl-button type="submit"
                               name="provider"
                               value="@provider.Name"
                               variant="primary"
                               class="w-full">
                        Register with @provider.DisplayName
                    </sl-button>
                }
            </form>
        </div>
    }
    else
    {
        <div class="mt-8 text-sm text-center text-[var(--sl-color-neutral-500)]">
            No external authentication services are configured.
            <br />
            <a class="text-blue-400 hover:underline"
               href="https://go.microsoft.com/fwlink/?LinkID=532715"
               target="_blank">
                Learn how to enable external providers
            </a>.
        </div>
    }
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
